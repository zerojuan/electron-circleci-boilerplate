machine:
  node:
    version: 5.2.0
dependencies:
  pre:
    - sudo dpkg --add-architecture i386
    - sudo add-apt-repository -y ppa:ubuntu-wine/ppa
    - sudo apt-get update
    - sudo apt-get install -y wine1.8
    - sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF
    - echo "deb http://download.mono-project.com/repo/debian wheezy main" | sudo tee /etc/apt/sources.list.d/mono-xamarin.list
    - sudo apt-get update
    - sudo apt-get install mono-complete
    - sudo apt-get install ruby ruby-dev gcc make icnsutils graphicsmagick xz-utils
    - gem install fpm
  override:
    - npm set progress=false
    - npm install
    - npm install rimraf -g
deployment:
  release:
    tag: /v[0-9]+(\.[0-9]+)*/
    commands:
      - npm run dist
      - node ./build/release-to-github.js
